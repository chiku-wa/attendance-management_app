<%#
社員情報の登録画面
%>

<%# HTMLのtitle定義部 %>
<% provide(:title, I18n.t("devise.registrations.new.sign_up")) %>

<%= render "devise/shared/error_messages", resource: resource %>

<%# Bootstrapのcol幅を調整するための変数 %>
<%
  # ----- ヘッダ
  col_width_header = 2

  # ----- 入力欄
  # 入力欄:1つ
  col_width_input_one = (12 - col_width_header) / 1

  # 入力欄:2つ
  col_width_input_two = (12 - col_width_header) / 2

  # 入力欄:3つ
  col_width_input_three = (12 - col_width_header) / 3
%>

<%= form_for(resource, as: resource_name, url: registration_path(resource_name)) do |f| %>

<div class="form-row text-left">

  <%# ----- メールアドレス %>
  <div class="form-group col-md-<%=col_width_header%>">
    <%= f.label :email %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.email_field(
          :email,
          placeholder: Employee.human_attribute_name(:email),
          autofocus: true,
          autocomplete: "email",
          class: "form-control",
        )
      %>
  </div>

  <%# ----- 社員コード %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :employee_code %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.text_field(
          :employee_code,
          placeholder: Employee.human_attribute_name(:employee_code),
          autocomplete: "employee_code",
          class: "form-control",
        )
    %>
  </div>

  <%# ----- 社員名(姓・名) %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :employee_full_name %>
  </div>

  <%# 社員名(姓) %>
  <div class="form-group col-<%=col_width_input_two%>">
    <%= f.text_field(
          :employee_last_name,
          placeholder: Employee.human_attribute_name(:employee_last_name),
          class: "form-control",
        )
    %>
  </div>

  <%# 社員名(名) %>
  <div class="form-group col-<%=col_width_input_two%>">
    <%= f.text_field(
          :employee_first_name,
          placeholder: Employee.human_attribute_name(:employee_first_name),
          class: "form-control",
        )
    %>
  </div>

  <%# ----- 社員名カナ(姓・名) %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :employee_full_name_kana %>
  </div>

  <%# 社員名カナ(姓) %>
  <div class="form-group col-<%=col_width_input_two%>">
    <%= f.text_field(
          :employee_last_name_kana,
          placeholder: Employee.human_attribute_name(:employee_last_name_kana),
          class: "form-control",
        )
    %>
  </div>

  <div class="form-group col-<%=col_width_input_two%>">
    <%# 社員名カナ(名) %>
    <%= f.text_field(
    :employee_first_name_kana,
          placeholder: Employee.human_attribute_name(:employee_first_name_kana),
          class: "form-control",
        )
    %>
  </div>

  <%# ----- 年齢 %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :age %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.text_field(
          :age,
          placeholder: Employee.human_attribute_name(:age),
          class: "form-control",
        )
    %>
  </div>

  <%# ----- 部署 %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label I18n.t("master_data.affiliation_type.affiliation_type_name.regular") %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.collection_select(
          :department_ids,
          # 社員がすでに所属している部署(本務・兼務)以外を除外してドロップダウンに表示する
          Department.where.not(id: current_employee.departments.ids),
          :id,
          :department_name,
          # 1行目をデフォルト値とする
          {prompt: false},
          {class: "form-control"},
        )
    %>
    <%= f.collection_select(
          :department_ids,
          # 社員がすでに所属している部署(本務・兼務)以外を除外してドロップダウンに表示する
          Department.where.not(id: current_employee.departments.ids),
          :id,
          :department_name,
          # 1行目をデフォルト値とする
          {prompt: false},
          {class: "form-control"},
        )
    %>
  </div>

  <%# ----- 権限 %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label Role.human_attribute_name(:role_name) %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.collection_select(
          :role_ids,
          Role.all,
          :id,
          :role_name,
          {
            # デフォルト値は「一般社員」とする
            selected: 3,
          },
          {class: "form-control"},
        )
    %>
  </div>

  <%# ----- 就業状況 %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :employment_status %>
  </div>
  <div class="form-group col-<%=col_width_input_one%>">
    <%= f.collection_select(
          :employment_status_id,
          EmploymentStatus.all,
          :id,
          :status_name,
          {
            # デフォルト値は「在職」とする
            selected: 1,
          },
          {class: "form-control"},
        )
    %>
  </div>

  <%# ----- パスワード設定 %>
  <div class="form-group col-<%=col_width_header%>">
    <%= f.label :password %>
  </div>

  <div class="form-group col-<%=col_width_input_one%>">
    <%# パスワード %>
    <%= f.password_field(
          :password,
          autocomplete: "new-password",
          placeholder: I18n.t("devise.passwords.edit.new_password"),
          class: "form-control",
        )
    %>

    <%# パスワード(確認用) %>
    <%= f.password_field(
          :password_confirmation,
          autocomplete: "new-password",
          placeholder: I18n.t("devise.passwords.edit.confirm_new_password"),
          class: "form-control",
        )
    %>

  </div>
</div>


<div class="actions">
  <%= f.submit I18n.t("devise.registrations.new.sign_up"), {class: "btn btn-primary devise-form"} %>
</div>
<% end %>

<%= render "devise/shared/links" %>
